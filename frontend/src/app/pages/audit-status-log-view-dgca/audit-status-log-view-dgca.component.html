<div class="container flex flex-col items-center justify-center py-8 gap-4">
  <div
    class="flex justify-center bg-white overflow-y-auto custom-scrollbar"
    style="height: calc(100vh - 196px)"
  >
    <div
      *ngIf="data"
      class="bg-white w-[29.7cm] min-h-[21cm] border pt-[0.6cm] pl-[1cm] pr-[1cm]"
      id="contentToConvert"
    >
      <img
        src="assets/images/gmf-doa-logo-2.png"
        alt="logodoa"
        class="h-11 mx-auto"
      />
      <div
        class="grid grid-cols-[795px_250px] border-black border-[1px] mt-6 w-full font-myriad leading-none"
      >
        <div
          class="border-black border-r-[1px] flex justify-center text-lg font-bold pb-2 pt-1"
        >
          AUDIT STATUS LOG
        </div>
        <div>
          <div
            class="grid grid-cols-[60px_1fr] px-[6px] border-b-[1px] border-black text-sm pb-2"
          >
            <div>Doc. No :</div>

            <div class="italic">{{ data.doc_nbr }}</div>
          </div>
          <div class="grid grid-cols-[40px_1fr] px-[6px] text-sm pb-2">
            <div>Date :</div>

            <div class="italic">{{ getFormattedStatusLogDate() }}</div>
          </div>
        </div>
      </div>
      <div class="font-myriad leading-none mt-4">
        <div class="w-full border-[1px] border-b-0 border-black text-[11pt]">
          <div
            class="grid grid-cols-[30px_62px_62px_62px_50px_245px_35px_45px_150px_60px_135px_50px_60px] border-black text-[8pt] border-b-[1px]"
          >
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              No.
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              NCR No.
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Issue Date
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Name/Date of Response
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Level of Finding
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Non-Conformance
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Audit Area
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Times occured
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Corrective Actions
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Name/ Target Date
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Follow up Audit Result
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Evidence
            </div>
            <div
              class="text-center pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Closing Date
            </div>
          </div>
          <div
            *ngFor="let ncrForm of data.ncrForms; let i = index"
            class="grid grid-cols-[30px_62px_62px_62px_50px_245px_35px_45px_150px_60px_135px_50px_60px] border-black text-[8pt] border-b-[1px]"
          >
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ i + 1 }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ ncrForm.NCR_nbr }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ getFormattedIssuedDate() }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ getFormattedAnswerDueDate() }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ ncrForm.Level_of_Finding }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ ncrForm.Encountered_Condition }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ ncrForm.Responsible_Office }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ ncrForm.times_occurred }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              <ng-container *ngFor="let ncrReply of data.ncrReplies">
                <div>
                  {{ ncrReply.Corrective_Action }}
                </div>
              </ng-container>
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              {{ getFormattedImplementationDate() }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              <ng-container
                *ngFor="let ncrFollowResult of data.ncrFollowResults"
              >
                <div>
                  {{ ncrFollowResult.followup_audit_result }}
                </div>
              </ng-container>
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              <ng-container
                *ngFor="let ncrFollowResult of data.ncrFollowResults"
              >
                <div>
                  {{ ncrFollowResult.evidence }}
                </div>
              </ng-container>
            </div>
            <div
              class="border-black pb-2 pt-1 whitespace-pre-line break-words px-1"
            >
              <ng-container
                *ngFor="let ncrFollowResult of data.ncrFollowResults"
              >
                <div>
                  {{ getFormattedVerifiedDate() }}
                </div>
              </ng-container>
            </div>
          </div>
        </div>
        <div class="font-medium text-lg my-3">Actions</div>
        <div
          class="min-w-full border-[1px] border-b-0 border-black text-[11pt]"
        >
          <div
            class="grid grid-cols-[35px_48px_70px_62px_425px_35px_46px_80px_180px_60px] border-black text-[8pt] border-b-[1px]"
          >
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              No.
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Action No.
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Reference PACR No.
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Issue Date
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Action Description
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Audit Area
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Status
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Implementation Date
            </div>
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Evidence
            </div>

            <div
              class="text-center pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              Closing Date
            </div>
          </div>
          <div
            *ngFor="let actionLog of data.actionLogs; let i = index"
            class="grid grid-cols-[35px_48px_70px_62px_425px_35px_46px_80px_180px_60px] border-black text-[8pt] border-b-[1px]"
          >
            <div
              class="text-center border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ i + 1 }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ actionLog.action_nbr }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ actionLog.reference_PACLR_nbr }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ getFormattedActionIssuedDate() }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ actionLog.action_description }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ actionLog.audit_area }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ actionLog.status }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ getFormattedImplementationActionDate() }}
            </div>
            <div
              class="border-r-[1px] border-black pb-2 pt-1 px-1 whitespace-pre-line break-words"
            >
              {{ actionLog.evidence }}
            </div>
            <div class="pb-2 pt-1 px-1 whitespace-pre-line break-words">
              {{ getFormattedCloseDate() }}
            </div>
          </div>
        </div>

        <div class="grid grid-cols-2 border-black border-[1px] mt-4 text-[9pt]">
          <div class="text-center border-r-[1px] border-black pt-1 pb-4">
            Prepared by <br />
            Independent Monitoring Inspector
          </div>
          <div class="text-center border-black pt-1 pb-4">
            Checked by <br />
            Chief of Independent Monitoring
          </div>
        </div>
        <div
          class="grid grid-cols-2 border-black border-[1px] border-t-0 text-[9pt]"
        >
          <div class="border-r-[1px] border-black">
            <div class="flex items-center mt-12">
              <div class="pl-[6px]">Name :</div>
              <div class="pl-1">{{ data.prepared_by }}</div>
            </div>
            <div class="flex items-center mb-3">
              <div class="pl-[6px]">Date :</div>
              <div class="pl-1">{{ getFormattedPreparedtDate() }}</div>
            </div>
          </div>
          <div class="border-black">
            <div class="flex items-center mt-12">
              <div class="pl-[6px]">Name :</div>
              <div class="pl-1">{{ data.checked_by }}</div>
            </div>
            <div class="flex items-center mb-3">
              <div class="pl-[6px]">Date :</div>
              <div class="pl-1">{{ getFormattedCheckedDate() }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <app-button (click)="convertToPDF()">Download</app-button>
</div>
